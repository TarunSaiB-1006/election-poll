<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Official Ballot - General Election 2024</title>
    <style>
      /* --- BLUE & RED COLOR SCHEME --- */

      /* 1. Header (Top Bar) */
      .ballot-header {
        background: #0051ff !important; /* Deep blue */
        color: #fff !important;
        text-align: center;
        padding: 20px;
      }

      /* 2. Background */
      body {
        background: #fff !important;
      }

      /* 3. Candidate Boxes */
      .candidate-option {
        min-height: 240px;
        padding: 48px 40px;
        font-size: 1.5rem;

        background: #e3e8fa !important; /* Light blue */
        border: none !important; /* Remove border */
        color: #003366 !important; /* Dark blue text */
        border-radius: 20px;
        box-shadow: 0 4px 16px rgba(51, 51, 102, 0.1);
        transition: box-shadow 0.2s, border-color 0.2s, background 0.2s;
        display: flex;
        align-items: center;
        gap: 40px;
        margin-bottom: 40px;
        box-sizing: border-box;
      }

      /* 4. Candidate Text */
      .candidate-option .candidate-name,
      .candidate-option .candidate-details {
        color: #fff !important;
        font-weight: bold;
        font-size: 1.25rem;
        text-shadow: 0 1px 4px #000a;
        letter-spacing: 0.5px;
      }

      /* 5. Toggle Switch (Selected State) */
      .candidate-option.selected .indicator-light {
        background: #d32f2f !important; /* Red */
        border-color: #d32f2f !important;
        box-shadow: 0 0 8px 2px #d32f2f !important;
      }
      .candidate-option.selected .indicator-light::after {
        background: radial-gradient(
          circle at 30% 30%,
          #d32f2f 60%,
          #a31515 100%
        ) !important;
        box-shadow: 0 0 8px 2px #d32f2f !important;
      }

      /* 7. “Submit Ballot” Button */
      .submit-button {
        background: #0033a0 !important; /* Blue */
        color: #fff !important;
        border: none;
        border-radius: 8px;
        padding: 16px 40px;
        font-size: 1.2rem;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 51, 160, 0.15);
        transition: background 0.2s, box-shadow 0.2s;
      }
      .submit-button:hover {
        background: #d32f2f !important; /* Red on hover */
        box-shadow: 0 0 12px 2px #e3e8fa;
      }

      /* 8. Borders and Lines */
      .ballot-container {
        max-width: 1200px;
        min-height: 900px;
        margin: 0 auto;
        background: #fff;
        border: 2px solid #0033a0 !important;
        border-radius: 20px;
      }

      /* 9. Hover Effects */
      .candidate-option:hover {
        box-shadow: 0 0 16px 4px #e3e8fa;
        border-color: #ffffff !important;
        background: #c5d2f2 !important;
      }
      .selection-button {
        height: 100%;
        min-height: 80px;
        min-width: 160px;
        font-size: 1.5rem;
        padding: 0 32px;
        border-radius: 35px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-sizing: border-box;
        background: #0033a0 !important;
        color: #fff !important;
        border: none;
        cursor: pointer;
        transition: background 0.2s, box-shadow 0.2s;
        box-shadow: 0 3px 10px rgba(0, 51, 160, 0.15);
      }

      /* Green on hover and when selected */
      .selection-button:hover,
      .candidate-option.selected .selection-button {
        background: #00b86b !important;
        color: #fff !important;
        box-shadow: 0 0 12px 2px #b6f5d8;
      }

      /* Remove gradients and non-blue/red colors from candidate-option and ballot-header */
      .candidate-option,
      .ballot-header {
        background-image: none !important;
      }

      body {
        font-family: Arial, sans-serif;
        background: #f5f5f5;
        margin: 0;
        padding: 20px;
      }

      .ballot-container {
        max-width: 1600px;
        margin: 0 auto;
        background: white;
        border: 2px solid #333;
      }

      .ballot-header {
        background: linear-gradient(90deg, #4f8cff, #6ee7b7, #fbbf24);
        color: #fff;
        text-align: center;
        padding: 20px;
      }

      .ballot-title {
        font-size: 32px;
        font-weight: bold;
        margin: 0 0 8px 0;
        letter-spacing: 2px;
      }

      .election-info {
        font-size: 18px;
        margin: 0 0 8px 0;
        font-weight: normal;
      }

      .voting-instruction {
        font-size: 14px;
        margin: 0;
        font-weight: normal;
      }

      .instructions-section {
        background: #e8e8e8;
        padding: 15px 20px;
        border-bottom: 1px solid #ccc;
      }

      .instructions-title {
        font-size: 16px;
        font-weight: bold;
        margin: 0 0 8px 0;
        color: #333;
      }

      .instructions-text {
        font-size: 14px;
        color: #333;
        margin: 0;
        line-height: 1.4;
      }

      .race-section {
        padding: 20px;
      }

      .race-header {
        text-align: center;
        margin-bottom: 20px;
        border-bottom: 2px solid #333;
        padding-bottom: 10px;
      }

      .race-title {
        font-size: 24px;
        font-weight: bold;
        margin: 0 0 5px 0;
        color: #333;
      }

      .race-subtitle {
        font-size: 14px;
        color: #666;
        margin: 0;
      }

      .candidates-container {
        display: grid;
        grid-template-columns: 1fr 1fr; /* Two columns side by side */
        gap: 12px; /* Reduced from 32px */
        width: 100%;
      }

      .candidate-option {
        background: linear-gradient(135deg, #ffffff 0%, #ffffff 100%);
        border: 2px solid #ffffff;
        box-shadow: 0 4px 16px rgba(79, 140, 255, 0.15);
        padding: 32px 24px;
        display: flex;
        align-items: center;
        gap: 20px;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
      }

      .candidate-option:hover {
        transform: scale(1.03);
        box-shadow: 0 8px 24px rgb(255, 255, 255);
      }

      .candidate-logo {
        width: 200px;
        height: 200px;
        background: #ffffff;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 32px;
        font-weight: bold;
        flex-shrink: 0;
        border-radius: 16px;
      }

      .candidate-name {
        font-size: 20px;
        font-weight: bold;
        color: #333;
        flex-grow: 1;
      }

      .voting-controls {
        display: flex;
        align-items: center;
        gap: 15px;
        flex-direction: row; /* Ensure left-to-right order */
      }

      .indicator-light {
        width: 35px;
        height: 35px;
        background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
        border: 2px solid #ccc !important; /* Use neutral border, not green */
        border-radius: 50%;
        transition: all 0.3s ease;
        flex-shrink: 0;
        position: relative;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3),
          inset 0 -2px 4px rgba(255, 255, 255, 0.1),
          0 2px 6px rgba(0, 0, 0, 0.2);
        order: 0;
      }

      .selection-button {
        background: linear-gradient(90deg, #4f8cff, #fbbf24);
        color: #fff;
        border: none;
        border-radius: 35px;
        cursor: pointer;
        transition: background 0.2s;
        box-shadow: 0 3px 10px rgba(0, 123, 255, 0.3);
        flex-shrink: 0;
        font-size: 2rem; /* Makes any icon or text inside bigger */
        order: 1;
      }

      .selection-button:hover {
        background: linear-gradient(90deg, #6ee7b7, #4f8cff);
        color: #222;
      }

      /* LED housing inner ring */
      .indicator-light::before {
        content: "";
        position: absolute;
        top: 3px;
        left: 3px;
        right: 3px;
        bottom: 3px;
        background: #4a4a4a;
        border-radius: 50%;
        box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.2),
          inset 0 -1px 2px rgba(0, 0, 0, 0.5);
      }

      /* LED dome (actual light) */
      .indicator-light::after {
        content: "";
        position: absolute;
        top: 6px;
        left: 6px;
        right: 6px;
        bottom: 6px;
        background: radial-gradient(circle at 30% 30%, #666, #333);
        border-radius: 50%;
        transition: all 0.3s ease;
        box-shadow: inset 0 1px 3px rgba(255, 255, 255, 0.3),
          inset 0 -1px 3px rgba(0, 0, 0, 0.7);
      }

      /* Selected state - glowing red LED */
      .candidate-option.selected .indicator-light {
        background: linear-gradient(145deg, #3a1a1a, #2a1212);
        border-color: #b81212;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3),
          inset 0 -2px 4px rgba(255, 100, 100, 0.1),
          0 0 20px rgba(220, 53, 69, 0.6), 0 2px 6px rgba(0, 0, 0, 0.2);
        animation: ledPulse 2s infinite;
      }

      .candidate-option.selected .indicator-light::before {
        background: #6a2a2a;
        box-shadow: inset 0 1px 2px rgba(255, 150, 150, 0.3),
          inset 0 -1px 2px rgba(0, 0, 0, 0.5);
      }

      .candidate-option.selected .indicator-light::after {
        background: radial-gradient(
          circle at 30% 30%,
          #ff6b6b,
          #dc3545,
          #8b0000
        );
        box-shadow: inset 0 1px 3px rgba(255, 200, 200, 0.6),
          inset 0 -1px 3px rgba(139, 0, 0, 0.8), 0 0 15px rgba(220, 53, 69, 0.8),
          0 0 25px rgba(220, 53, 69, 0.4);
      }

      @keyframes ledPulse {
        0%,
        100% {
          box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3),
            inset 0 -2px 4px rgba(255, 100, 100, 0.1),
            0 0 20px rgba(220, 53, 69, 0.6), 0 2px 6px rgba(0, 0, 0, 0.2);
        }
        50% {
          box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3),
            inset 0 -2px 4px rgba(255, 100, 100, 0.1),
            0 0 30px rgba(220, 53, 69, 0.8), 0 0 40px rgba(220, 53, 69, 0.4),
            0 2px 6px rgba(0, 0, 0, 0.2);
        }
      }

      /* Additional highlight on LED dome when lit */
      .candidate-option.selected .indicator-light:before {
        box-shadow: inset 0 1px 2px rgba(255, 150, 150, 0.4),
          inset 0 -1px 2px rgba(0, 0, 0, 0.5), 0 0 10px rgba(220, 53, 69, 0.3);
      }

      .submit-section {
        padding: 30px;
        text-align: center;
        border-top: 1px solid #ccc;
      }

      .submit-button {
        background: rgb(81, 86, 90);
        color: white;
        border: none;
        padding: 12px 30px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.2s ease;
      }
      .submit-button:hover {
        background: #2d5a85;
      }
      .submit-button:disabled {
        background: #999;
        cursor: not-allowed;
      }

      /* --- DARK MODE BALLOT --- */

      html, body {
        background: #181a20 !important;
        color: #f5f7fa !important;
      }

      .ballot-container {
        background: #23262f !important;
        border: 2px solid #00b86b !important;
        border-radius: 20px;
        box-shadow: 0 8px 32px #000a;
      }

      .ballot-header {
        background: linear-gradient(90deg, #23262f 60%, #00b86b 100%) !important;
        color: #f5f7fa !important;
        text-align: center;
        padding: 20px;
        border-radius: 20px 20px 0 0;
        box-shadow: 0 2px 12px #0008;
      }

      .ballot-title {
        font-size: 32px;
        font-weight: bold;
        margin: 0 0 8px 0;
        letter-spacing: 2px;
        color: #fff !important;
        text-shadow: 0 2px 8px #000c;
      }

      .election-info,
      .voting-instruction {
        color: #b6c3e0 !important;
      }

      .instructions-section {
        background: #232c3b !important;
        color: #f5f7fa !important;
        border-bottom: 1px solid #00b86b;
      }

      .instructions-title {
        color: #fff !important;
      }

      .race-section {
        padding: 20px;
      }

      .race-header {
        text-align: center;
        margin-bottom: 20px;
        border-bottom: 2px solid #00b86b;
        padding-bottom: 10px;
      }

      .race-title {
        font-size: 24px;
        font-weight: bold;
        margin: 0 0 5px 0;
        color: #fff !important;
      }

      .race-subtitle {
        color: #b6c3e0 !important;
      }

      .candidates-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
        width: 100%;
      }

      .candidate-option {
        background: #232c3b !important;
        border: 2px solid #232c3b !important;
        color: #f5f7fa !important;
        border-radius: 20px;
        box-shadow: 0 4px 16px #000a;
        transition: box-shadow 0.2s, border-color 0.2s, background 0.2s;
        display: flex;
        align-items: center;
        gap: 40px;
        margin-bottom: 0;
        box-sizing: border-box;
        cursor: pointer;
      }

      .candidate-option:hover {
        box-shadow: 0 0 16px 4px #00b86b99;
        border-color: #00b86b !important;
        background: #26313f !important;
      }

      .candidate-option.selected {
        border: 2px solid #00b86b !important;
        background: #1a222e !important;
        box-shadow: 0 0 24px 2px #00b86bcc;
      }

      .candidate-logo {
        width: 80px;
        height: 80px;
        background: #00b86b !important;
        color: #181a20 !important;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 32px;
        font-weight: bold;
        flex-shrink: 0;
        border-radius: 16px;
        box-shadow: 0 2px 8px #000a;
      }

      .candidate-name {
        font-size: 20px;
        font-weight: bold;
        color: #f5f7fa !important;
        flex-grow: 1;
      }

      .voting-controls {
        display: flex;
        align-items: center;
        gap: 15px;
        flex-direction: row; /* Ensure left-to-right order */
      }

      .indicator-light {
        width: 35px;
        height: 35px;
        background: #23262f;
        border: 2px solid #ccc !important; /* Use neutral border, not green */
        border-radius: 50%;
        transition: all 0.3s ease;
        flex-shrink: 0;
        position: relative;
        box-shadow: 0 2px 6px #00b86b55;
        order: 0;
      }

      .selection-button {
        background: #00b86b !important;
        color: #fff !important;
        border: none;
        border-radius: 35px;
        cursor: pointer;
        transition: background 0.2s, box-shadow 0.2s;
        box-shadow: 0 3px 10px #00b86b55;
        flex-shrink: 0;
        font-size: 2rem;
        order: 1;
      }

      .selection-button:hover,
      .candidate-option.selected .selection-button {
        background: #2d5a85 !important;
        color: #fff !important;
        box-shadow: 0 0 12px 2px #00b86b99;
      }

      .candidate-option.selected .indicator-light {
        background: #00b86b;
        border-color: #fff;
        box-shadow: 0 0 20px #00b86bcc, 0 2px 6px #00b86b55;
        animation: ledPulseDark 2s infinite;
      }

      .candidate-option.selected .indicator-light::before {
        background: #fff;
        box-shadow: 0 1px 2px #b6f5d8, 0 -1px 2px #00b86b;
      }

      .candidate-option.selected .indicator-light::after {
        background: radial-gradient(circle at 30% 30%, #fff, #00b86b, #26313f);
        box-shadow: 0 1px 3px #b6f5d8, 0 -1px 3px #003a1a, 0 0 15px #00b86bcc, 0 0 25px #00b86b66;
      }

      @keyframes ledPulseDark {
        0%, 100% {
          box-shadow: 0 0 20px #00b86b99, 0 2px 6px #00b86b55;
        }
        50% {
          box-shadow: 0 0 30px #00b86bcc, 0 0 40px #00b86b66, 0 2px 6px #00b86b55;
        }
      }

      /* Popup dark mode */
      #thankyou-popup .popup-content {
        background: #23262f !important;
        color: #f5f7fa !important;
        box-shadow: 0 8px 32px #000a !important;
      }
      #thankyou-popup h2 {
        color: #00b86b !important;
      }
      #thankyou-popup .popup-btn {
        background: #00b86b !important;
        color: #fff !important;
      }

      /* Progress bar dark mode */
      .progress-bar-container {
        background: #232c3b !important;
        border: 2px solid #00b86b !important;
      }
      .progress-bar-fill {
        background: linear-gradient(90deg, #00b86b 60%, #4ade80 100%) !important;
        box-shadow: 0 0 12px #00b86b44 !important;
      }

      /* Responsive styles (dark mode tweaks) */
      @media (max-width: 600px) {
        .ballot-container {
          background: #23262f !important;
          border-radius: 10px;
          padding: 0 2vw;
          box-sizing: border-box;
        }
        .candidate-option {
          background: #232c3b !important;
          border-radius: 8px;
        }
        .candidate-logo {
          background: #00b86b !important;
        }
        .submit-section {
          background: #23262f !important;
        }
      }
      @media (max-width: 430px) {
        .ballot-container {
          background: #23262f !important;
          border-radius: 8px;
        }
        .candidate-option {
          background: #232c3b !important;
          border-radius: 7px;
        }
        .candidate-logo {
          background: #00b86b !important;
        }
      }

      /* Welcome Step Styles */
      #welcome-step {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        text-align: center;
        padding: 0 20px;
      }
      #welcome-step h1 {
        font-size: 2.5rem;
        margin-bottom: 24px;
        color: #003366;
      }
      #welcome-step p {
        font-size: 1.2rem;
        margin-bottom: 32px;
        color: #333;
      }
      #welcome-step .submit-button {
        font-size: 1.3rem;
        padding: 18px 48px;
        background: #00b86b;
        color: #fff;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background 0.2s, transform 0.2s;
        box-shadow: 0 4px 16px rgba(0, 184, 107, 0.3);
      }
      #welcome-step .submit-button:hover {
        background: #2d5a85;
        transform: translateY(-2px);
      }

      .vote-overlay {
        position: absolute;
        left: 0; right: 0; top: 0; bottom: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.4s cubic-bezier(.4,1.2,.4,1);
        font-size: 1.1rem;
        font-weight: bold;
        color: #fff;
        background: rgba(0, 184, 107, 0.92);
        border-radius: 8px;
        z-index: 2;
      }
      .selection-button.selected + .vote-overlay,
      .vote-overlay.active {
        opacity: 1;
        pointer-events: auto;
      }
      /* Make voting-controls relative for overlay positioning */
      .voting-controls {
        position: relative;
        display: flex;
        align-items: center;
        gap: 15px;
        flex-direction: row;
      }
      /* Make indicator-light look clickable only when enabled */
      .indicator-light {
        border: 2px solid #ccc !important;
        box-shadow: none !important;
        cursor: not-allowed;
        transition: border-color 0.3s;
      }
      .candidate-option.ready-to-vote .indicator-light {
        cursor: pointer;
        border-color: #00b86b !important;
        box-shadow: 0 0 8px #00b86b55;
      }
    </style>
  </head>
  <body>
  {% load static %}
<div class="ballot-container ballot-page" id="welcome-step" style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 600px;">
  <h1 style="font-size: 2.5rem; margin-bottom: 24px;">Welcome to the Election Ballot</h1>
  <p style="font-size: 1.2rem; margin-bottom: 32px;">Thank you for participating in the General Election 2024.<br>Please click below to begin voting.</p>
  <button class="submit-button" style="font-size: 1.3rem; padding: 18px 48px;" onclick="showStep('bspl')">Begin Voting</button>
</div>

  <div class="ballot-container ballot-page" id="page-1" style="display: none;">
      <div class="ballot-header">
        <h1 class="ballot-title">OFFICIAL BALLOT</h1>
        <p class="election-info">General Election 2024</p>
        <p class="voting-instruction">Mark your choices clearly</p>
      </div>

      <!-- Ballot Sections -->
      <div id="ballot-bspl" class="ballot-step">
        <div class="race-section">
          <div class="race-header">
            <h2 class="race-title">BSPL</h2>
            <p class="race-subtitle">Vote for one (1)</p>
          </div>
          <div class="candidates-container">
            <!-- 10 Placeholder Candidates for BSPL -->
            <div class="candidate-option" data-candidate="bspl1">
              <div class="candidate-logo"></div>
              <div class="candidate-name">Candidate Name</div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="bspl2">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="bspl3">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="bspl4">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="bspl5">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="bspl6">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="bspl7">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="bspl8">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="bspl9">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="bspl10">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
          </div>
        </div>
        <div class="submit-section">
          <button
            class="submit-button"
            onclick="submitVote('bspl')"
            style="display: none"
          >
            SUBMIT BALLOT
          </button>
        </div>
      </div>

      <div id="ballot-baspl" class="ballot-step" style="display: none">
        <div class="race-section">
          <div class="race-header">
            <h2 class="race-title">BASPL</h2>
            <p class="race-subtitle">Vote for one (1)</p>
          </div>
          <div class="candidates-container">
            <!-- 10 Placeholder Candidates for BASPL -->
            <div class="candidate-option" data-candidate="baspl1">
              <div class="candidate-logo"></div>
              <div class="candidate-name">Candidate Name</div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="baspl2">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="baspl3">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="baspl4">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="baspl5">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="baspl6">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="baspl7">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="baspl8">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="baspl9">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="baspl10">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
          </div>
        </div>
        <div class="submit-section">
          <button
            class="submit-button"
            onclick="submitVote('baspl')"
            style="display: none"
          >
            SUBMIT BALLOT
          </button>
        </div>
      </div>

      <div id="ballot-gspl" class="ballot-step" style="display: none">
        <div class="race-section">
          <div class="race-header">
            <h2 class="race-title">GSPL</h2>
            <p class="race-subtitle">Vote for one (1)</p>
          </div>
          <div class="candidates-container">
            <!-- 10 Placeholder Candidates for GSPL -->
            <div class="candidate-option" data-candidate="gspl1">
              <div class="candidate-logo"></div>
              <div class="candidate-name">Candidate Name</div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gspl2">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gspl3">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gspl4">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gspl5">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gspl6">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gspl7">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gspl8">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gspl9">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gspl10">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
          </div>
        </div>
        <div class="submit-section">
          <button
            class="submit-button"
            onclick="submitVote('gspl')"
            style="display: none"
          >
            SUBMIT BALLOT
          </button>
        </div>
      </div>

      <div id="ballot-gaspl" class="ballot-step" style="display: none">
        <div class="race-section">
          <div class="race-header">
            <h2 class="race-title">GASPL</h2>
            <p class="race-subtitle">Vote for one (1)</p>
          </div>
          <div class="candidates-container">
            <!-- 10 Placeholder Candidates for GASPL -->
            <div class="candidate-option" data-candidate="gaspl1">
              <div class="candidate-logo"></div>
              <div class="candidate-name">Candidate Name</div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gaspl2">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gaspl3">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gaspl4">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gaspl5">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gaspl6">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gaspl7">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gaspl8">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gaspl9">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
            <div class="candidate-option" data-candidate="gaspl10">
              <div class="candidate-logo"></div>
              <div class="candidate-name"></div>
              <div class="voting-controls">
                <span class="indicator-light"></span>
                <button class="selection-button">Select</button>
              </div>
            </div>
          </div>
        </div>
        <!-- REMOVE the submit-section for GASPL -->
      </div>
    </div>

    <!-- Designer Thank You Popup -->
<div id="thankyou-popup" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.35); z-index:9999; align-items:center; justify-content:center;">
  <div class="popup-content" style="background:#fff; border-radius:18px; padding:40px 32px; box-shadow:0 8px 32px #0002; min-width:320px; max-width:90vw; display:flex; flex-direction:column; align-items:center;">
    <h2 style="color:#00b86b; margin-bottom:24px;">Your Vote has been counted</h2>
    <div class="progress-bar-container" style="width:340px; max-width:90vw; margin-bottom:24px;">
      <div class="progress-bar-fill" id="progress-bar-fill"></div>
    </div>
    <button class="popup-btn" onclick="document.getElementById('thankyou-popup').style.display='none';" style="margin-top:12px; padding:10px 28px; border:none; background:#00b86b; color:#fff; border-radius:8px; font-size:1rem; cursor:pointer;">Close</button>
  </div>
</div>

<style>
.progress-bar-container {
  width: 340px;
  height: 48px;
  background: #e6f7ee;
  border-radius: 24px;
  overflow: hidden;
  box-shadow: 0 1px 10px rgba(0,0,0,0.06);
  border: 2px solid #b6f5d8;
  display: flex;
  align-items: center;
}
.progress-bar-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #00b86b 60%, #4ade80 100%);
  border-radius: 24px 0 0 24px;
  transition: width 1.2s cubic-bezier(.23,1.01,.32,1);
  box-shadow: 0 0 12px #00b86b44;
}
@media (max-width: 500px) {
  .progress-bar-container {
    width: 90vw;
    min-width: 0;
  }
}
</style>

    <script>
function setupCandidateOptionEvents() {
  document.querySelectorAll('.candidate-option').forEach(option => {
    const selectionBtn = option.querySelector('.selection-button');
    const indicator = option.querySelector('.indicator-light');

    // Reset state
    option.classList.remove('ready-to-vote');
    selectionBtn.classList.remove('selected');
    indicator.classList.remove('active-indicator');

    // Selection button click
    selectionBtn.onclick = (e) => {
      e.preventDefault();
      // Remove ready state from all options in this race
      option.parentElement.querySelectorAll('.candidate-option').forEach(opt => {
        opt.classList.remove('ready-to-vote');
        opt.querySelector('.selection-button').classList.remove('selected');
        opt.querySelector('.indicator-light').classList.remove('active-indicator');
      });
      // Set ready state for this option
      option.classList.add('ready-to-vote');
      selectionBtn.classList.add('selected');
      indicator.classList.add('active-indicator');
    };

    // Indicator click
    indicator.onclick = (e) => {
      if (!option.classList.contains('ready-to-vote')) return;
      const stepDiv = option.closest('.ballot-step');
      const stepId = stepDiv ? stepDiv.id.replace('ballot-', '') : null;
      if (stepId) {
        selections[stepId] = option.getAttribute('data-candidate');
        if (stepId === "gaspl") {
          // Show thank you popup with progress bar
          showThankYouPopup();
        } else {
          submitVote(stepId);
        }
      }
    };
  });
}

// Show thank you popup with animated progress bar
function showThankYouPopup() {
  document.getElementById('thankyou-popup').style.display = 'flex';
  // Animate progress bar
  let container = document.querySelector('#thankyou-popup .progress-bar-container');
  container.innerHTML = '<div class="progress-bar-fill" id="progress-bar-fill"></div>';
  setTimeout(() => {
    document.getElementById('progress-bar-fill').style.width = '100%';
  }, 100);
}

// Call after DOM is ready and after each step is shown
document.addEventListener('DOMContentLoaded', setupCandidateOptionEvents);

// Also call after showing each step
function showStep(step) {
  // Hide all ballot pages
  document.querySelectorAll('.ballot-page').forEach(page => page.style.display = 'none');
  // Hide all ballot steps
  document.querySelectorAll('.ballot-step').forEach(stepDiv => stepDiv.style.display = 'none');

  if (step === "welcome-step") {
    document.getElementById("welcome-step").style.display = "flex";
  } else {
    document.getElementById("welcome-step").style.display = "none";
    document.getElementById("page-1").style.display = "block";
    document.getElementById(`ballot-${step}`).style.display = "block";
    currentStep = step;
    setupCandidateOptionEvents(); // <-- Add this line
  }
}

// Store selections as an object (or use an array if you prefer)
let selections = {
  bspl: null,
  baspl: null,
  gspl: null,
  gaspl: null,
};
let currentStep = "bspl";
const steps = ["bspl", "baspl", "gspl", "gaspl"];

// Attach click handlers to all candidate options for all steps
steps.forEach((step, idx) => {
document.querySelectorAll(`#ballot-${step} .candidate-option`).forEach(option => {
  option.addEventListener("click", () => {
    // Deselect all in this step
    document.querySelectorAll(`#ballot-${step} .candidate-option`).forEach(opt => opt.classList.remove("selected"));
    option.classList.add("selected");

    // Get candidate ID and name
    const candidateId = option.dataset.candidate || option.dataset.candidateId;
    const candidateName = option.querySelector('.candidate-name')?.textContent || option.children[1]?.textContent || "";

    selections[step] = candidateName;
    uuid[step] = candidateId;

    // Register vote for this candidate
    voteForCandidate(candidateId);

    if (step === "gaspl") {
      // On last step, show thank you popup and reset after close
      document.getElementById("thankyou-popup").style.display = "flex";
      setTimeout(() => {
        document.getElementById("progress-bar-fill").style.width = "5%";
      }, 200);

      document.querySelector("#thankyou-popup .popup-btn").onclick = function() {
        document.getElementById("thankyou-popup").style.display = "none";
        // Reset selections for a new round
        selections = { bspl: null, baspl: null, gspl: null, gaspl: null };
        uuid = { bspl: null, baspl: null, gspl: null, gaspl: null };
        document.querySelectorAll(".candidate-option").forEach((opt) => {
          opt.classList.remove("selected");
          opt.style.pointerEvents = "";
          opt.style.opacity = "";
        });
        document.getElementById("progress-bar-fill").style.width = "0%";
        showStep("welcome-step");
      };
    } else {
      // Go to next step after a short delay for visual feedback
      setTimeout(() => showStep(steps[idx + 1]), 200);
    }
  });
});
});

      // Enable/disable next button based on selection
      function updateNextButton(step) {
        const nextButton = document.querySelector(
          `#ballot-${step} .next-button`
        );
        if (nextButton) {
          nextButton.disabled = !selections[step];
        }
      }

      // Submit logic for each step (no disabling, just go to next step)
      function submitVote(step) {
  if (!selections[step]) {
    return;
  }
  if (step === "gaspl") {
    for (step in uuid) {
      voteForCandidate(uuid[step]);
    }
    // Show the popup with progress bar and message
    document.getElementById("thankyou-popup").style.display = "flex";
    document.querySelectorAll(".candidate-option").forEach((option) => {
      option.style.pointerEvents = "none";
      option.style.opacity = "0.7";
    });
    document.querySelectorAll(".submit-button").forEach((btn) => {
      btn.disabled = true;
      btn.textContent = "BALLOT SUBMITTED";
    });

    // Animate the progress bar to a small visible amount (e.g., 5%)
    setTimeout(() => {
      document.getElementById("progress-bar-fill").style.width = "5%";
    }, 200);
  } else {
    const idx = steps.indexOf(step);
    showStep(steps[idx + 1]);
  }
}

      // Show the correct step/page by id
      function showStep(step) {
          // Hide all ballot pages
          document.querySelectorAll('.ballot-page').forEach(page => page.style.display = 'none');
          // Hide all ballot steps
          document.querySelectorAll('.ballot-step').forEach(stepDiv => stepDiv.style.display = 'none');

          if (step === "welcome-step") {
            document.getElementById("welcome-step").style.display = "flex";
          } else {
            document.getElementById("welcome-step").style.display = "none";
            document.getElementById("page-1").style.display = "block";
            document.getElementById(`ballot-${step}`).style.display = "block";
            currentStep = step;
            setupCandidateOptionEvents(); // <-- Add this line
          }
        }

      // Next step logic
      function goToStep(step) {
        showStep(step);
      }

      function goNextStep() {
        const idx = steps.indexOf(currentStep);
        if (idx < steps.length - 1) {
          showStep(steps[idx + 1]);
        }
      }

      // Back step logic
      function goBackStep() {
        const idx = steps.indexOf(currentStep);
        if (idx > 0) {
          showStep(steps[idx - 1]);
        }
      }

      // Initialize: show welcome screen first
      showStep("welcome-step");
    </script>
  </body>
</html>
